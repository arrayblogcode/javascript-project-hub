<!DOCTYPE html>
<html>
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Array Blog - Music Hub</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body{
            min-height: 50vh;
            display: flex;
            align-items:center;
        }
        .progress{cursor: pointer; height: 8px;}
        .active-song{
            background: #37f3ff !important; color:#0d6efd; font-weight: bold; 
        }
    </style>

</head>
    <body>

        <div class="container">
        <div class="row g-4">
            <div class="col-lg-8">
                <div class="card shadow">
                    <div class="card-body p-4 text-center">
                      
                        <h2 class="card-title mb-1" id="title">Song Title</h2>
                        <p class="text-muted mb-4" id="artist">Artist Name</p>
                       

                        <audio id="audio-element"></audio>  
                        <div class="progress mb-4" id="progress-box"> 
                            <div class="progress-bar" id="progress-fill" style="width:0%"></div>
                        </div>

                        <div clas="d-flex justify-content-cnter gap-3">
                            <button class="btn btn-primary px-4" onclick="changeSong(-1)">Prev</button>
                            <button class="btn btn-primary px-4" id="play-pause" onclick="togglePlay()">Play</button>
                            <button class="btn btn-primary px-4" onclick="changeSong(1)">Next</button>
                        </div>
                        
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="card shadow">
                    <div class="card-body">
                       <h5 class="card-title border-bottom pb-2 mb-3">Playlist</h5>
                       <div id="plyalist-list"></div>
                    </div>
                </div>
            </div>


        </div>
    </div>

    <script>
        const song = [
            {title:"ABC", artist: "ABC", src:"song1.mp3"},
            {title:"ABC1", artist: "ABC1", src:"song2.mp3"},
            {title:"ABC2", artist: "ABC2", src:"song3.mp3"},
            {title:"ABC3", artist: "ABC3", src:"song4.mp3"},
            {title:"ABC4", artist: "ABC4", src:"song5.mp3"}
        ];

        let currentIdx= 0;
        let isPlaying = false;

        const audio = document.getElementById("audio-element");
        const title = document.getElementById("title");
        const artist = document.getElementById("artist");
        const playBtn = document.getElementById("play-pause");
        const progressFill = document.getElementById("progress-fill");
        const progressBox = document.getElementById("progress-box");
        const playlistCntainer = document.getElementById("plyalist-list");


        function loadSong(index){
            currentIdx = index;
            audio.src= song[index].src;
            title.innerText = song[index].title;
            artist.innerText = song[index].artist;
            upadatePlaylistUI();
        }

        function togglePlay(){
            if(isPlaying){
                audio.pause();
                playBtn.innerText="Play";
                isPlaying=false;
            }
            else{
                audio.play();
                playBtn.innerText="Pause";
                isPlaying=true;
            }
        }

        function changeSong(direction){
            currentIdx = (currentIdx + direction +song.length) % song.length;
            loadSong(currentIdx);
            audio.play();
            playBtn.innerText="Pause";
            isPlaying=true;
        }

       audio.addEventListener('timeupdate', () => {
        if (audio.duration) {
            const progressPercent = (audio.currentTime / audio.duration) * 100;
            progressFill.style.width = `${progressPercent}%`;
        }
    });


        progressBox.addEventListener('click',  (e) => {
            const width = progressBox.clientWidth;
            const clickX =  e.offsetX;
            audio.currentTime = (clickX / width) * audio.duration;
        })

        function renderPlaylist(){
            playlistCntainer.innerHTML = '';
            song.forEach((songItem, i) =>{
                const div = document.createElement('div');
                div.className='list-group-item list-group-item-action';
                div.innerText =  `${i + 1}. ${songItem.title}`;
                div.onclick= () =>{
                    loadSong(i);
                    audio.play();
                    isPlaying=true;
                    playBtn.innerText="Pause";
                };
                playlistCntainer.appendChild(div);
            })
        }

function upadatePlaylistUI(){
    const items = document.querySelectorAll('.list-group-item');
    items.forEach((item, i) =>{
        if(i === currentIdx) item.classList.add('active-song');
        else item.classList.remove('active-song');
        
    })
}

    audio.addEventListener('ended', () => changeSong(1));



        renderPlaylist();
        loadSong(0);
    </script>

    </body>
</html>
